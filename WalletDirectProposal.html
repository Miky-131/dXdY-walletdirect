<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">ol.lst-kix_9xkkwegrbbqq-5.start{counter-reset:lst-ctn-kix_9xkkwegrbbqq-5 0}.lst-kix_9xkkwegrbbqq-1>li{counter-increment:lst-ctn-kix_9xkkwegrbbqq-1}ol.lst-kix_f1eunbjy7jnj-0{list-style-type:none}ol.lst-kix_f1eunbjy7jnj-1{list-style-type:none}ol.lst-kix_f1eunbjy7jnj-2{list-style-type:none}ol.lst-kix_f1eunbjy7jnj-3{list-style-type:none}ol.lst-kix_f1eunbjy7jnj-4{list-style-type:none}ol.lst-kix_f1eunbjy7jnj-5{list-style-type:none}ol.lst-kix_9xkkwegrbbqq-8.start{counter-reset:lst-ctn-kix_9xkkwegrbbqq-8 0}.lst-kix_f1eunbjy7jnj-3>li{counter-increment:lst-ctn-kix_f1eunbjy7jnj-3}ol.lst-kix_f1eunbjy7jnj-6{list-style-type:none}ol.lst-kix_f1eunbjy7jnj-7{list-style-type:none}ol.lst-kix_f1eunbjy7jnj-8{list-style-type:none}.lst-kix_9xkkwegrbbqq-0>li{counter-increment:lst-ctn-kix_9xkkwegrbbqq-0}ol.lst-kix_f1eunbjy7jnj-1.start{counter-reset:lst-ctn-kix_f1eunbjy7jnj-1 0}.lst-kix_9xkkwegrbbqq-7>li{counter-increment:lst-ctn-kix_9xkkwegrbbqq-7}.lst-kix_f1eunbjy7jnj-2>li:before{content:"" counter(lst-ctn-kix_f1eunbjy7jnj-2,lower-roman) ". "}.lst-kix_f1eunbjy7jnj-2>li{counter-increment:lst-ctn-kix_f1eunbjy7jnj-2}ol.lst-kix_9xkkwegrbbqq-2.start{counter-reset:lst-ctn-kix_9xkkwegrbbqq-2 0}.lst-kix_f1eunbjy7jnj-1>li:before{content:"" counter(lst-ctn-kix_f1eunbjy7jnj-1,lower-latin) ". "}ol.lst-kix_f1eunbjy7jnj-4.start{counter-reset:lst-ctn-kix_f1eunbjy7jnj-4 0}ol.lst-kix_9xkkwegrbbqq-4.start{counter-reset:lst-ctn-kix_9xkkwegrbbqq-4 0}.lst-kix_9xkkwegrbbqq-8>li{counter-increment:lst-ctn-kix_9xkkwegrbbqq-8}.lst-kix_f1eunbjy7jnj-0>li:before{content:"" counter(lst-ctn-kix_f1eunbjy7jnj-0,decimal) ". "}.lst-kix_9xkkwegrbbqq-2>li{counter-increment:lst-ctn-kix_9xkkwegrbbqq-2}.lst-kix_9xkkwegrbbqq-5>li{counter-increment:lst-ctn-kix_9xkkwegrbbqq-5}.lst-kix_f1eunbjy7jnj-5>li{counter-increment:lst-ctn-kix_f1eunbjy7jnj-5}.lst-kix_f1eunbjy7jnj-8>li{counter-increment:lst-ctn-kix_f1eunbjy7jnj-8}ol.lst-kix_f1eunbjy7jnj-2.start{counter-reset:lst-ctn-kix_f1eunbjy7jnj-2 0}ol.lst-kix_9xkkwegrbbqq-1.start{counter-reset:lst-ctn-kix_9xkkwegrbbqq-1 0}ol.lst-kix_f1eunbjy7jnj-5.start{counter-reset:lst-ctn-kix_f1eunbjy7jnj-5 0}ol.lst-kix_f1eunbjy7jnj-8.start{counter-reset:lst-ctn-kix_f1eunbjy7jnj-8 0}.lst-kix_9xkkwegrbbqq-3>li:before{content:"" counter(lst-ctn-kix_9xkkwegrbbqq-3,decimal) ". "}.lst-kix_9xkkwegrbbqq-2>li:before{content:"" counter(lst-ctn-kix_9xkkwegrbbqq-2,lower-roman) ". "}.lst-kix_9xkkwegrbbqq-4>li:before{content:"" counter(lst-ctn-kix_9xkkwegrbbqq-4,lower-latin) ". "}.lst-kix_f1eunbjy7jnj-6>li{counter-increment:lst-ctn-kix_f1eunbjy7jnj-6}ol.lst-kix_f1eunbjy7jnj-3.start{counter-reset:lst-ctn-kix_f1eunbjy7jnj-3 0}.lst-kix_9xkkwegrbbqq-0>li:before{content:"" counter(lst-ctn-kix_9xkkwegrbbqq-0,decimal) ". "}ol.lst-kix_9xkkwegrbbqq-0.start{counter-reset:lst-ctn-kix_9xkkwegrbbqq-0 0}ol.lst-kix_9xkkwegrbbqq-3.start{counter-reset:lst-ctn-kix_9xkkwegrbbqq-3 0}.lst-kix_9xkkwegrbbqq-8>li:before{content:"" counter(lst-ctn-kix_9xkkwegrbbqq-8,lower-roman) ". "}.lst-kix_f1eunbjy7jnj-0>li{counter-increment:lst-ctn-kix_f1eunbjy7jnj-0}.lst-kix_9xkkwegrbbqq-1>li:before{content:"" counter(lst-ctn-kix_9xkkwegrbbqq-1,lower-latin) ". "}.lst-kix_9xkkwegrbbqq-3>li{counter-increment:lst-ctn-kix_9xkkwegrbbqq-3}ol.lst-kix_f1eunbjy7jnj-7.start{counter-reset:lst-ctn-kix_f1eunbjy7jnj-7 0}ol.lst-kix_9xkkwegrbbqq-7.start{counter-reset:lst-ctn-kix_9xkkwegrbbqq-7 0}.lst-kix_9xkkwegrbbqq-4>li{counter-increment:lst-ctn-kix_9xkkwegrbbqq-4}.lst-kix_9xkkwegrbbqq-7>li:before{content:"" counter(lst-ctn-kix_9xkkwegrbbqq-7,lower-latin) ". "}.lst-kix_9xkkwegrbbqq-6>li:before{content:"" counter(lst-ctn-kix_9xkkwegrbbqq-6,decimal) ". "}.lst-kix_9xkkwegrbbqq-5>li:before{content:"" counter(lst-ctn-kix_9xkkwegrbbqq-5,lower-roman) ". "}ol.lst-kix_9xkkwegrbbqq-7{list-style-type:none}ol.lst-kix_9xkkwegrbbqq-8{list-style-type:none}ol.lst-kix_9xkkwegrbbqq-1{list-style-type:none}.lst-kix_f1eunbjy7jnj-3>li:before{content:"" counter(lst-ctn-kix_f1eunbjy7jnj-3,decimal) ". "}ol.lst-kix_9xkkwegrbbqq-2{list-style-type:none}.lst-kix_f1eunbjy7jnj-4>li:before{content:"" counter(lst-ctn-kix_f1eunbjy7jnj-4,lower-latin) ". "}ol.lst-kix_9xkkwegrbbqq-0{list-style-type:none}ol.lst-kix_9xkkwegrbbqq-5{list-style-type:none}.lst-kix_f1eunbjy7jnj-5>li:before{content:"" counter(lst-ctn-kix_f1eunbjy7jnj-5,lower-roman) ". "}ol.lst-kix_f1eunbjy7jnj-6.start{counter-reset:lst-ctn-kix_f1eunbjy7jnj-6 0}ol.lst-kix_9xkkwegrbbqq-6{list-style-type:none}li.li-bullet-0:before{margin-left:-18pt;white-space:nowrap;display:inline-block;min-width:18pt}ol.lst-kix_9xkkwegrbbqq-3{list-style-type:none}ol.lst-kix_9xkkwegrbbqq-4{list-style-type:none}.lst-kix_f1eunbjy7jnj-1>li{counter-increment:lst-ctn-kix_f1eunbjy7jnj-1}.lst-kix_f1eunbjy7jnj-7>li:before{content:"" counter(lst-ctn-kix_f1eunbjy7jnj-7,lower-latin) ". "}.lst-kix_f1eunbjy7jnj-4>li{counter-increment:lst-ctn-kix_f1eunbjy7jnj-4}.lst-kix_f1eunbjy7jnj-6>li:before{content:"" counter(lst-ctn-kix_f1eunbjy7jnj-6,decimal) ". "}.lst-kix_9xkkwegrbbqq-6>li{counter-increment:lst-ctn-kix_9xkkwegrbbqq-6}.lst-kix_f1eunbjy7jnj-7>li{counter-increment:lst-ctn-kix_f1eunbjy7jnj-7}ol.lst-kix_f1eunbjy7jnj-0.start{counter-reset:lst-ctn-kix_f1eunbjy7jnj-0 0}.lst-kix_f1eunbjy7jnj-8>li:before{content:"" counter(lst-ctn-kix_f1eunbjy7jnj-8,lower-roman) ". "}ol.lst-kix_9xkkwegrbbqq-6.start{counter-reset:lst-ctn-kix_9xkkwegrbbqq-6 0}ol{margin:0;padding:0}table td,table th{padding:0}.c1{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Courier New";font-style:normal}.c3{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left;height:11pt}.c4{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c6{color:#000000;text-decoration:none;vertical-align:baseline;font-size:11pt;font-style:normal}.c14{color:#000000;text-decoration:none;vertical-align:baseline;font-size:11pt;font-style:italic}.c7{padding-top:0pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c17{-webkit-text-decoration-skip:none;color:#1155cc;text-decoration:underline;text-decoration-skip-ink:none}.c13{background-color:#ffffff;max-width:468pt;padding:72pt 72pt 72pt 72pt}.c2{border:1px solid black;margin:5px}.c16{color:inherit;text-decoration:inherit}.c5{padding:0;margin:0}.c9{font-weight:400;font-family:"Arial"}.c0{font-weight:700;font-family:"Courier New"}.c8{font-weight:400;font-family:"Courier New"}.c12{height:11pt}.c10{margin-left:36pt}.c11{padding-left:0pt}.c15{margin-left:72pt}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="c13"><p class="c4"><span class="c6 c0">Current Proposal</span></p><p class="c3"><span class="c1"></span></p><p class="c4"><span class="c8">Current proposal is at </span><span class="c8 c17"><a class="c16" href="https://www.google.com/url?q=https://docs.google.com/document/d/1Z93XY9tkO2hbnruD9Q1LVnK0BjELgqWUfWu21vKMynU/edit?usp%3Dsharing&amp;sa=D&amp;source=editors&amp;ust=1636676480051000&amp;usg=AOvVaw1DTOqKs4EQdy7eCVayA4t7">https://docs.google.com/document/d/1Z93XY9tkO2hbnruD9Q1LVnK0BjELgqWUfWu21vKMynU/edit?usp=sharing</a></span></p><p class="c3"><span class="c1"></span></p><p class="c4"><span class="c6 c0">Background</span></p><p class="c3"><span class="c1"></span></p><p class="c4"><span class="c1">Wallet Connect and Walletlink are designed for communication between desktop dApp and mobile wallet, which resides on two different devices. The communication is done through a bridge server. Both dApp and wallet connect to the server with websocket. </span></p><p class="c3"><span class="c1"></span></p><p class="c4"><span class="c1">Although it is possible to connect dApp and wallet on the same mobile device with the same protocols, there is an inherent technical limitation. When mobile apps (both dApp and wallet) are backgrounded, they are paused by the OS after a short period of time, thus losing the websocket connection to the server.</span></p><p class="c3"><span class="c1"></span></p><p class="c4"><span class="c1">Wallet Connect 2.0 and Walletlink are designed to recover the connection. Walletlink has no adoption, other than Coinbase Wallet. Wallet Connect 2.0 is still in the early stage with mobile SDK in beta, and only useful if both dApp and wallet support it.</span></p><p class="c3"><span class="c1"></span></p><p class="c4"><span class="c1">Even in the ideal situation, having a constant websocket connection to an external server is an extra point of failure. The connection may be lost as the user is on the move. The server may be overloaded and cannot process the traffic.</span></p><p class="c3"><span class="c1"></span></p><p class="c4"><span class="c1">When both dApp and wallet are located on the same device, there is no need to route the traffic through an external server. This proposal is to facilitate the communication between dApp and wallet through deeplinks.</span></p><p class="c3"><span class="c1"></span></p><p class="c4"><span class="c6 c0">Usage</span></p><p class="c3"><span class="c1"></span></p><p class="c4"><span class="c1">This protocol is designed to perform multiple methods in one pass. For example, the dApp may request the wallet to sign multiple messages, or to sign multiple messages and send one transaction. The wallet should inform the user about the resource of the connection, and can either prompt the user for confirmation for each method, or a single confirmation for all methods.</span></p><p class="c3"><span class="c1"></span></p><p class="c4"><span class="c1">The response only returns success if all actions are successful. When successful, the response should contain the results of each action.</span></p><p class="c3"><span class="c1"></span></p><p class="c4"><span class="c6 c0">Public registry</span></p><p class="c3"><span class="c1"></span></p><p class="c4"><span class="c1">Both dApp and wallet should have a custom link for the connection and use params to pass data. The dApp should be a native app released through Apple App Store or Google Play.</span></p><p class="c3"><span class="c1"></span></p><p class="c4"><span class="c1">The communication is always initiated by dApp. For the dApp to be aware of the installed wallet apps supporting this protocol, there needs to be a public registry with wallet info. For security reasons, the wallet app uses dApp registry for validation callbacks.</span></p><p class="c3"><span class="c1"></span></p><p class="c4"><span class="c0 c14">Best practices: Although the registry is available as a public github repo, the Wallet app should take a snapshot of the registry as build time and include it as part of the app, to avoid man-in-the-middle attack on the repo.</span></p><p class="c3"><span class="c1"></span></p><p class="c4"><span class="c1">Note: If the protocol support is added to an existing wallet, the wallet should add a new deep link scheme, so the dApp can differentiate different builds of the wallet and only use this protocol if wallet supports it.</span></p><p class="c3"><span class="c1"></span></p><p class="c4"><span class="c0">dApp registry</span><sup><a href="#cmnt1" id="cmnt_ref1">[a]</a></sup><sup><a href="#cmnt2" id="cmnt_ref2">[b]</a></sup></p><p class="c3"><span class="c1"></span></p><p class="c4"><span class="c1">{</span></p><p class="c4"><span class="c1">&nbsp; &nbsp;&quot;(dapp_uuid)&quot;:{</span></p><p class="c4"><span class="c1">&nbsp; &nbsp; &nbsp; &quot;name&quot;:&quot;(dApp name)&quot;,</span></p><p class="c4"><span class="c1">&nbsp; &nbsp; &nbsp; &quot;platforms&quot;:{</span></p><p class="c4"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;ios&quot;:{</span></p><p class="c4"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;bundleId&quot;:&quot;(Bundle ID of the app, with format of TEAMID.com.company.app&quot;</span></p><p class="c4"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;},</span></p><p class="c4"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;android&quot;:{</span></p><p class="c4"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;packageId&quot;:&quot;(Package ID of the app, with format of com.company.app)&quot;,</span></p><p class="c4"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;hash&quot;:[</span></p><p class="c4"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;(The registry should be updated with the hash of each release&quot;</span></p><p class="c4"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ]</span></p><p class="c4"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c4"><span class="c1">&nbsp; &nbsp; &nbsp; },</span></p><p class="c4"><span class="c1">&nbsp; &nbsp; &nbsp; &quot;deeplink&quot;:&quot;(deep link scheme and path to return response)&quot;,</span></p><p class="c4"><span class="c1">&nbsp; &nbsp; &nbsp; &quot;metadata&quot;:{</span></p><p class="c4"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;shortName&quot;:&quot;(Short name for dApp to display)&quot;,</span></p><p class="c4"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;imageUrl&quot;:&quot;(image URL for the wallet logo)&quot;,</span></p><p class="c4"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;developer&quot;:&quot;(dApp developer name)&quot;,</span></p><p class="c4"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;developerUrl&quot;:&quot;(dApp developer website URL)&quot;</span></p><p class="c4"><span class="c1">&nbsp; &nbsp; &nbsp; }</span></p><p class="c4"><span class="c1">&nbsp; &nbsp;}</span></p><p class="c4"><span class="c1">}</span></p><p class="c3"><span class="c1"></span></p><p class="c3"><span class="c1"></span></p><p class="c3"><span class="c1"></span></p><p class="c3"><span class="c1"></span></p><p class="c4"><span class="c0">Wallet registry</span><span class="c8">&nbsp;</span><sup><a href="#cmnt3" id="cmnt_ref3">[c]</a></sup></p><p class="c3"><span class="c1"></span></p><p class="c4"><span class="c1">{</span></p><p class="c4"><span class="c1">&nbsp; &nbsp;&quot;(wallet_uuid)&quot;:{</span></p><p class="c4"><span class="c1">&nbsp; &nbsp; &nbsp; &quot;name&quot;:&quot;(Wallet name)&quot;,</span></p><p class="c4"><span class="c1">&nbsp; &nbsp; &nbsp; &quot;deeplink&quot;:&quot;(deep link scheme and path to send request&quot;,</span></p><p class="c4"><span class="c1">&nbsp; &nbsp; &nbsp; &quot;platforms&quot;:{</span></p><p class="c4"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;ios&quot;:{</span></p><p class="c4"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;supported&quot;:[</span></p><p class="c4"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;(list of dApp ID)&quot;</span></p><p class="c4"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ]</span></p><p class="c4"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;},</span></p><p class="c4"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;android&quot;:{</span></p><p class="c4"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;supported&quot;:[</span></p><p class="c4"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;(list of dApp ID)&quot;</span></p><p class="c4"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ]</span></p><p class="c4"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c4"><span class="c1">&nbsp; &nbsp; &nbsp; },</span></p><p class="c4"><span class="c1">&nbsp; &nbsp; &nbsp; &quot;metadata&quot;:{</span></p><p class="c4"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;shortName&quot;:&quot;(Short name for dApp to display)&quot;,</span></p><p class="c4"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;imageUrl&quot;:&quot;(image URL for the wallet logo)&quot;,</span></p><p class="c4"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;developer&quot;:&quot;(dApp developer name)&quot;,</span></p><p class="c4"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;developerUrl&quot;:&quot;(dApp developer website URL)&quot;</span></p><p class="c4"><span class="c1">&nbsp; &nbsp; &nbsp; }</span></p><p class="c4"><span class="c1">&nbsp; &nbsp;}</span></p><p class="c4"><span class="c1">}</span></p><p class="c3"><span class="c1"></span></p><p class="c3"><span class="c1"></span></p><p class="c3"><span class="c1"></span></p><p class="c4"><span class="c6 c0">Params Format</span></p><p class="c3"><span class="c1"></span></p><p class="c4"><span class="c1">Similar to webpage URL, deeplinks can process data in URL params.</span></p><p class="c3"><span class="c1"></span></p><p class="c4"><span class="c1">To simplify development, the protocol can use a single param, which is a base64 encoded string of a JSON body.</span></p><p class="c3"><span class="c1"></span></p><p class="c4"><span class="c6 c0">(wallet_deep_link)?data=(base64_encoded_json_string)</span></p><p class="c3"><span class="c1"></span></p><p class="c4"><span class="c6 c0">Payload Format from dApp to wallet</span></p><p class="c3"><span class="c0 c6"></span></p><p class="c4"><span class="c1">The data param is a base64 encoded JSON body, containing the request for the connection, and a list of actions for the wallet to perform.</span></p><p class="c3"><span class="c1"></span></p><p class="c4"><span class="c1">{</span></p><p class="c4"><span class="c1">&nbsp; &nbsp;&quot;dapp_uuid&quot;:&quot;(dApp UUID in registry)&quot;,</span></p><p class="c4"><span class="c1">&nbsp; &nbsp;&quot;chainId&quot;:&quot;(optional)&quot;,</span></p><p class="c4"><span class="c1">&nbsp; &nbsp;&quot;account&quot;:&quot;(optional, desired wallet account ID)&quot;,</span></p><p class="c4"><span class="c1">&nbsp; &nbsp;&quot;methods&quot;:[</span></p><p class="c4"><span class="c1">&nbsp; &nbsp;]</span></p><p class="c4"><span class="c1">}</span></p><p class="c3"><span class="c1"></span></p><p class="c4"><span class="c0">dapp_uuid</span><span class="c1">&nbsp;identifies the dApp&rsquo;s UUID in the registry. Wallet should use the registry to fetch dApp&rsquo;s information and display dApp&rsquo;s name and image to the user. If dapp_uuid does not exists in the registry, Wallet should respond with NOOP</span></p><p class="c3"><span class="c1"></span></p><p class="c4"><span class="c1">From the dApp registry</span></p><p class="c4"><span class="c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c0">name</span><span class="c1">&nbsp;is the full name of the dApp</span></p><p class="c3"><span class="c1"></span></p><p class="c4"><span class="c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c0">metaData.shortName </span><span class="c1">can be use for display to the user</span></p><p class="c3"><span class="c1"></span></p><p class="c4 c10"><span class="c0">metaData.imageUrl</span><span class="c1">&nbsp;is the image URL of the app icon</span></p><p class="c3 c10"><span class="c1"></span></p><p class="c4 c10"><span class="c0">metaData.developer</span><span class="c1">&nbsp;is the name of the dApp developer</span></p><p class="c3 c10"><span class="c1"></span></p><p class="c4 c10"><span class="c0">metaData.developerUrl</span><span class="c1">&nbsp;is the website URL of the developer</span></p><p class="c3"><span class="c6 c0"></span></p><p class="c4"><span class="c0">chainId</span><span class="c1">&nbsp;identifies the preferred chain ID of the network, such as 1 for MainNet or 3 for Ropsten. If chainId is different from the currently selected network in the Wallet App, Wallet App can either reject the connection, or automatically switch to the designated network. If chainId is null, Wallet App uses the currently selected network.</span></p><p class="c3"><span class="c1"></span></p><p class="c4"><span class="c0">account</span><span class="c1">&nbsp;identifies the requested account ID (ethereum address) of the wallet. &nbsp;If accountId is different from the currently selected account, Wallet App can either reject the connection, or automatically switch to the designated network. If the accountId does not belong to the wallet, Wallet App will reject the connection. If accountId is null, Wallet App should connect to the currently selected account.</span></p><p class="c3"><span class="c1"></span></p><p class="c4"><span class="c14 c0">Technical Note: Native dApps must include the supported deep link scheme at build time.</span></p><p class="c3"><span class="c1"></span></p><p class="c4"><span class="c0">methods</span><span class="c8">&nbsp;is a list of </span><span class="c0">method</span><span class="c1">&nbsp;object</span></p><p class="c3"><span class="c1"></span></p><p class="c4"><span class="c0">method</span><span class="c1">:</span></p><p class="c4"><span class="c1">{</span></p><p class="c4"><span class="c1">&nbsp; &nbsp;&quot;id&quot;:&quot;(unique ID, generated by dApp)&quot;,</span></p><p class="c4"><span class="c1">&nbsp; &nbsp;&quot;optional&quot;:true,</span></p><p class="c4"><span class="c1">&nbsp; &nbsp;&quot;JSON-RPC&quot;:&quot;(JSON-RPC method)&quot;</span></p><p class="c4"><span class="c1">}</span></p><p class="c3"><span class="c1"></span></p><p class="c4"><span class="c0">id </span><span class="c1">is generated by the dApp to identify the action, to make it easier to process the response</span></p><p class="c3"><span class="c1"></span></p><p class="c4"><span class="c0">optional</span><span class="c1">&nbsp;is an optional field indicating whether this is an optional method. It defaults to false, meaning the method is required. If it is false, the whole request stops if the user rejects this method. If it is true, the Wallet App should continue to process the next method even if the user rejects this method.</span></p><p class="c3"><span class="c1"></span></p><p class="c4"><span class="c0">JSON-RPC</span><span class="c8">&nbsp;is standard JSON-RPC method payload, supporting </span><span class="c0">eth_personalSign</span><span class="c8">, </span><span class="c0">eth_sign</span><span class="c8">, </span><span class="c0">eth_signTypedData</span><span class="c8">, </span><span class="c0">eth_sendTransaction</span><span class="c8">, </span><span class="c0">eth_sendRawTransaction</span><span class="c8">, </span><span class="c0">eth_signTransaction</span></p><p class="c3"><span class="c1"></span></p><p class="c4"><span class="c8">UX Notes: The Wallet App </span><span class="c8">should display </span><sup><a href="#cmnt4" id="cmnt_ref4">[d]</a></sup><sup><a href="#cmnt5" id="cmnt_ref5">[e]</a></sup><span class="c1">the dApp name, icon, developer name, and developer URL with the method requests. If the user taps on the developer URL, the Wallet App should launch the developer&rsquo;s website in a browser.</span></p><p class="c3"><span class="c1"></span></p><p class="c4"><span class="c1">UX Notes: When multiple methods are included, the Wallet App can choose to perform each method sequentially, or display them in a list and only request one confirmation.</span></p><p class="c3"><span class="c1"></span></p><p class="c4"><span class="c8">If Wallet App performs each method sequentially and the user rejects a </span><span class="c0">non-optional</span><span class="c8">&nbsp;method, </span><span class="c8">the rest of the methods are cancelled.</span><sup><a href="#cmnt6" id="cmnt_ref6">[f]</a></sup><sup><a href="#cmnt7" id="cmnt_ref7">[g]</a></sup></p><p class="c3"><span class="c1"></span></p><p class="c4"><span class="c8">When the user performs all methods without rejecting a non-optional method, the Wallet App should use the dApp registry&rsquo;s </span><span class="c0">callback</span><span class="c1">&nbsp;to launch a universal link or deep link, to pass the response back to the dApp.</span></p><p class="c3"><span class="c1"></span></p><p class="c4"><span class="c6 c0">(backlink)?data=(base64_encoded_json_string)</span></p><p class="c3"><span class="c1"></span></p><p class="c4"><span class="c8">The </span><span class="c0">result</span><span class="c1">&nbsp;is the a based64 encoded JSON body, which decodes to</span></p><p class="c3"><span class="c1"></span></p><p class="c4"><span class="c1">{</span></p><p class="c4"><span class="c1">&nbsp; &nbsp; &quot;successful&quot;:true,</span></p><p class="c4"><span class="c1">&nbsp; &nbsp; &quot;chainId&quot;:&quot;(connected chainId, if successful)&quot;,</span></p><p class="c4"><span class="c1">&nbsp; &nbsp; &quot;account&quot;:&quot;(connected wallet account, if successful)&quot;,</span></p><p class="c4"><span class="c1">&nbsp; &nbsp; &quot;responses&quot;:[</span></p><p class="c4"><span class="c8">&nbsp; &nbsp; &nbsp; &nbsp; (an array of </span><span class="c0">result</span><span class="c1">&nbsp;object)</span></p><p class="c4"><span class="c1">&nbsp; &nbsp; ]</span></p><p class="c4"><span class="c1">}</span></p><p class="c3"><span class="c1"></span></p><p class="c4"><span class="c0">successful</span><span class="c1">&nbsp;is a boolean indicating all methods are performed successfully.</span></p><p class="c3"><span class="c6 c0"></span></p><p class="c4"><span class="c0">chainId</span><span class="c1">&nbsp;identifies the connected chain ID of the network, if successful</span></p><p class="c3"><span class="c1"></span></p><p class="c4"><span class="c0">account</span><span class="c1">&nbsp;identifies the connected account ID (ethereum address) of the wallet, if successful</span></p><p class="c3"><span class="c1"></span></p><p class="c4"><span class="c0">responses</span><span class="c8">&nbsp;contains a list of </span><span class="c0">response</span><span class="c1">&nbsp;object</span></p><p class="c3"><span class="c1"></span></p><p class="c4"><span class="c0">response</span><span class="c1">:</span></p><p class="c4"><span class="c1">{</span></p><p class="c4"><span class="c1">&nbsp; &nbsp; &quot;id&quot;:&quot;(unique ID, generated by dApp)&quot;,</span></p><p class="c4"><span class="c1">&nbsp; &nbsp; &quot;successful&quot;:true,</span></p><p class="c4"><span class="c1">&nbsp; &nbsp; &quot;JSON-RPC&quot;:&quot;(JSON-RPC response)&quot;</span></p><p class="c4"><span class="c1">}</span></p><p class="c3"><span class="c1"></span></p><p class="c4"><span class="c0">id </span><span class="c1">is the action id generated by dApp.</span></p><p class="c3"><span class="c1"></span></p><p class="c4"><span class="c0">successful</span><span class="c1">&nbsp;is a boolean indicating whether this method was successful. </span></p><p class="c3"><span class="c1"></span></p><p class="c3"><span class="c1"></span></p><p class="c4"><span class="c0">JSON-RPC</span><span class="c1">&nbsp;is the standard JSON-RPC method response for the matching method.</span></p><p class="c3"><span class="c1"></span></p><p class="c4"><span class="c8">The number of items in </span><span class="c0">responses</span><span class="c8">&nbsp;must match the number of items in </span><span class="c0">methods</span><span class="c1">&nbsp;from dApp.</span></p><p class="c3"><span class="c1"></span></p><p class="c4"><span class="c1">If the user reject a non-optional method, the result body will contain:</span></p><p class="c3"><span class="c1"></span></p><p class="c4"><span class="c1">{</span></p><p class="c4"><span class="c1">&nbsp; &nbsp;&quot;successful&quot;:false,</span></p><p class="c4"><span class="c1">&nbsp; &nbsp;&quot;error&quot;:{</span></p><p class="c4"><span class="c1">&nbsp; &nbsp; &nbsp; &quot;id&quot;:&quot;(id of the method)&quot;,</span></p><p class="c4"><span class="c1">&nbsp; &nbsp; &nbsp; &quot;message&quot;:&quot;(error message from on chain)&quot;</span></p><p class="c4"><span class="c1">&nbsp; &nbsp;}</span></p><p class="c4"><span class="c1">}</span></p><p class="c3"><span class="c1"></span></p><p class="c4"><span class="c0">error</span><span class="c1">&nbsp;identifies the failed non-optional method, and contains a human readable message.</span></p><p class="c3"><span class="c1"></span></p><p class="c4"><span class="c0">id</span><span class="c1">&nbsp;is the method ID in dApp&rsquo;s request.</span></p><p class="c3"><span class="c1"></span></p><p class="c4"><span class="c0">message</span><span class="c1">&nbsp;is a human readable message identifying the cause of the failure. For example, it can be &ldquo;rejected by user&rdquo;, or &ldquo;not enough gas&rdquo;</span></p><p class="c3"><span class="c1"></span></p><p class="c4"><span class="c6 c0">Build Notes for dApps</span></p><p class="c3"><span class="c6 c0"></span></p><p class="c4"><span class="c1">At build time, dApp should retrieve the current Wallet registry, and add the deep link scheme into the build settings.</span></p><p class="c3"><span class="c1"></span></p><p class="c4"><span class="c1">Android dApp developer should update the dApp registry with the signature hash of each build</span></p><p class="c3"><span class="c1"></span></p><p class="c4"><span class="c6 c0">Build Notes for Wallets</span></p><p class="c3"><span class="c6 c0"></span></p><p class="c4"><span class="c1">At build time, Wallet should retrieve the current dApp registry, and add the deep link scheme into the build settings.</span></p><p class="c3"><span class="c1"></span></p><p class="c4"><span class="c1">Wallet should include a copy of the dApp registry in the app, and update the Wallet registry with the dApp ID&rsquo;s in the &nbsp;&ldquo;supported&rdquo; field.</span></p><p class="c3"><span class="c6 c0"></span></p><p class="c4"><span class="c6 c0">Security Notes</span></p><p class="c3"><span class="c6 c0"></span></p><p class="c4"><span class="c1">With version 1 of this spec, the deep link direct communication is only allowed between native dApp and Wallet. Wallet should verify against impersonation of the dApp.</span></p><p class="c3"><span class="c1"></span></p><p class="c4"><span class="c1">This is the recommended practice</span></p><p class="c3"><span class="c1"></span></p><ol class="c5 lst-kix_f1eunbjy7jnj-0 start" start="1"><li class="c4 c10 c11 li-bullet-0"><span class="c1">At build time, bundle the dApp registry with the Wallet app, and retrieve the current dApp registry at run time. Verify the calling dApp is in the build-time registry. If the calling dApp is in the run-time registry but not in the build-time registry, inform the user that he needs to update the Wallet app to the latest version. If the calling dApp is in neither registry, reject the requests.</span></li><li class="c4 c10 c11 li-bullet-0"><span class="c1">To verify the dApp on iOS</span></li></ol><ol class="c5 lst-kix_f1eunbjy7jnj-1 start" start="1"><li class="c4 c11 c15 li-bullet-0"><span class="c1">Unfortunately there is no way to get the app ID of the source app of the deep link. Centralized security measurements may be introduced later</span></li></ol><ol class="c5 lst-kix_f1eunbjy7jnj-0" start="3"><li class="c4 c10 c11 li-bullet-0"><span class="c1">To verify the dApp on Android</span></li></ol><ol class="c5 lst-kix_f1eunbjy7jnj-1 start" start="1"><li class="c4 c11 c15 li-bullet-0"><span class="c1">Potentially use PackageManager to get signature hash of the calling dApp, and check it against the dApp registry</span></li></ol><p class="c3"><span class="c1"></span></p><p class="c3"><span class="c1"></span></p><div class="c2"><p class="c7"><a href="#cmnt_ref1" id="cmnt1">[a]</a><span class="c6 c9">what is this? where is it stored?</span></p></div><div class="c2"><p class="c7"><a href="#cmnt_ref2" id="cmnt2">[b]</a><span class="c6 c9">Similar to Wallet Connect, the registry is on git. This is the WC registry repo:&nbsp;https://github.com/WalletConnect/walletconnect-registry and this is their data files:&nbsp;https://github.com/WalletConnect/walletconnect-registry/tree/master/public/data</span></p></div><div class="c2"><p class="c7"><a href="#cmnt_ref3" id="cmnt3">[c]</a><span class="c6 c9">also what is this and where is it stored?</span></p></div><div class="c2"><p class="c7"><a href="#cmnt_ref4" id="cmnt4">[d]</a><span class="c6 c9">Why is &quot;connection&quot; required anymore?</span></p><p class="c7 c12"><span class="c6 c9"></span></p><p class="c7"><span class="c6 c9">couldn&#39;t the wallet just show the actual requests to the user?</span></p></div><div class="c2"><p class="c7"><a href="#cmnt_ref5" id="cmnt5">[e]</a><span class="c6 c9">Technically they don&#39;t need to have a &quot;connection&quot; step. Their UX with WalletConnect usually show the dApp name and icon on top of request. I feel this is too light. I feel user needs to be slowed down and exam the request. It is too easy for a scam website to trigger a deep link, requesting user to transfer ETH to his wallet. If user doesn&#39;t pay attention, it is too easy to get tricked.</span></p></div><div class="c2"><p class="c7"><a href="#cmnt_ref6" id="cmnt6">[f]</a><span class="c6 c9">Are you still imagining that in the wallet the user would have to approve/deny each method separately? I feel like it would be better to have them approve/deny all at once</span></p><p class="c7 c12"><span class="c6 c9"></span></p><p class="c7"><span class="c6 c9">Of course wallets could implement it however they want, but we should push for what is ideal</span></p></div><div class="c2"><p class="c7"><a href="#cmnt_ref7" id="cmnt7">[g]</a><span class="c6 c9">Thats a good point. We can leave it to the wallet developers to decide their UX</span></p></div></body></html>